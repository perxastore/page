<!DOCTYPE html>
<html>
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8" />
    <title>Perxa</title>
</head>
<body>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
        import { query, where, getFirestore, collection, onSnapshot, limit} from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

  

        const firebaseConfig = {
        apiKey: "AIzaSyB7FJ8jzZgv4I4RW9-B6Q3U-RiZ0_ON_fg",
        authDomain: "perxa-e9bb2.firebaseapp.com",
        databaseURL: "https://perxa-e9bb2-default-rtdb.firebaseio.com",
        projectId: "perxa-e9bb2",
        storageBucket: "perxa-e9bb2.firebasestorage.app",
        messagingSenderId: "784850450102",
        appId: "1:784850450102:web:110962deb6e693aec19817",
        measurementId: "G-DMVEXWBG3L"
        };


        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const oversizeDiv = document.getElementById("oversizeRow");
        const q1 = query(
            collection(db, "items"),
            where("category", "==", "Oversize"),
            limit(3)
        );

        onSnapshot(q1, (snapshot) => {
            oversizeDiv.innerHTML = "";
            snapshot.forEach(doc => {
                const item = doc.data();
                if (item.status != "Vendido"){
                    const img = item.images?.[0] || "";
                    oversizeDiv.innerHTML += `
                    <div class="card" onclick="window.location.href='./item.html?id=${doc.id}'">
                        <img src="${img}" loading="lazy">
                        <h2>Q${item.price}</h2>
                        <h2>Talla ${item.size}</h2>    
                    </div>`;
                }
            });
        });


        const regularDiv = document.getElementById("regularRow");
        const q2 = query(
            collection(db, "items"),
            where("category", "==", "Regular"),
            limit(3)
        );

        onSnapshot(q2, (snapshot) => {
            regularDiv.innerHTML = "";
            snapshot.forEach(doc => {
                const item = doc.data();
                if (item.status != "Vendido"){
                    const img = item.images?.[0] || "";
                    regularDiv.innerHTML += ` 
                    <div class="card" onclick="window.location.href='./item.html?id=${doc.id}'">
                        <img src="${img}" loading="lazy">    
                        <h2>Q${item.price}</h2>
                        <h2>Talla ${item.size}</h2>    
                    </div>`;
                }
            
            });
        });


    </script>
    
    <div class="background"></div>

    <div id="mainCard">
        <div class="columnContainer" >
            <div class="homeBanner">
                <div class="columnCOntainer">
                    <h1>Perxa</h1>   
                    <h3>Menos buscar. Mejor vestir.</h3>    
                </div>
                
            </div>
            
            
            

            
            <div class="categoryTitle" onclick="window.location.href='./category.html?category=Oversize'">
                <h2>OVERSIZE ></h2>
            </div>
            <div id = "oversizeRow" class="rowDial" style="height: 600px;">
            </div>
            
            <div class="categoryTitle" onclick="window.location.href='./category.html?category=Regular'">
                <h2>REGULAR ></h2>
            </div>
            <div id = "regularRow" class="rowDial" style="height: 600px;">
            </div>
            
            <div class="foot">
                <h1>¿Por qué elegirnos?</h1>
                <img src="./icons/list.png">
                <h3>Prendas seleccionadas</h3>
                <img src="./icons/price.png">
                <h3>Precios accesibles</h3>
                <img src="./icons/ruler.png">
                <h3>Medidas exactas</h3>
                <img src="./icons/flag.png">
                <h3>Tienda 100% guatemalteca</h3>
            </div>
        </div>

    </div>
    
    

</body>
</html>